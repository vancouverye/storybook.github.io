<!doctype html><html lang="ko"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>ìŠ¤í† ë¦¬ë¶(ê´€ë¦¬ì í¸ì§‘ í¬í•¨)</title>
<style>
:root{--bg:#0b0e12;--panel:#11161c;--ink:#e7ecf2;--mut:#9aa4b2;--line:#1f2937;--acc:#60a5fa;--fs:18px;--lh:1.8}
*{box-sizing:border-box}body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Noto Sans KR,sans-serif;background:var(--bg);color:var(--ink)}
.btn,.in{border:1px solid var(--line);background:#0f141a;color:var(--ink);border-radius:10px;padding:8px 10px}
.app{display:grid;grid-template-columns:280px 1fr;grid-template-rows:auto 1fr auto;grid-template-areas:"s h""s m""s f";height:100vh}
.s{grid-area:s;background:var(--panel);border-right:1px solid var(--line);display:flex;flex-direction:column}
.h{grid-area:h;background:#0f141a;border-bottom:1px solid var(--line);padding:8px;display:flex;gap:8px;align-items:center}
.m{grid-area:m;overflow:auto;padding:18px}.f{grid-area:f;background:#0f141a;border-top:1px solid var(--line);padding:8px;display:flex;gap:8px;align-items:center}
.title{font-weight:900;font-size:clamp(18px,3vw,26px)}.meta{color:var(--mut);font-size:12px}.list{padding:8px;overflow:auto}
.item{padding:8px;border-radius:10px;cursor:pointer;border:1px solid transparent}.item:hover{background:#0f141a;border-color:var(--line)}.item.a{border-color:var(--acc);background:color-mix(in srgb,var(--acc),transparent 90%)}
.ch{padding:8px;border-radius:10px;cursor:pointer}.ch.a{background:color-mix(in srgb,var(--acc),transparent 90%)}
.content{line-height:var(--lh);font-size:var(--fs)}.content img{max-width:100%;border-radius:14px;display:block;margin:10px auto}
.bar{height:8px;background:var(--panel);border:1px solid var(--line);border-radius:999px;overflow:hidden}.p{height:100%;width:0;background:var(--acc)}
.badge{border:1px solid var(--line);border-radius:999px;color:var(--mut);padding:1px 8px;font-size:12px}
@media(max-width:980px){.app{grid-template-columns:1fr;grid-template-areas:"h""m""f"}.s{position:fixed;inset:0 35% 0 0;transform:translateX(-100%);transition:.2s;z-index:20}.s.on{transform:translateX(0)}.bk{display:none;position:fixed;inset:0;background:rgba(0,0,0,.3);z-index:10}.bk.on{display:block}}
/* ê´€ë¦¬ì ì„œë */
.dr{position:fixed;top:0;right:0;bottom:0;width:380px;background:var(--panel);border-left:1px solid var(--line);transform:translateX(100%);transition:.2s;z-index:30;display:flex;flex-direction:column}
.dr.on{transform:translateX(0)}.dr .hd{padding:10px;border-bottom:1px solid var(--line);display:flex;gap:8px;align-items:center}.dr .bd{padding:10px;display:flex;flex-direction:column;gap:8px;overflow:auto}
.ed{min-height:220px;border:1px dashed var(--line);border-radius:12px;background:#0f141a;padding:10px}
.hidden{display:none}body:not(.admin) .only-admin{display:none!important}
</style></head><body>
<div class="app">
  <aside id="S" class="s"><div style="padding:10px;border-bottom:1px solid var(--line);display:flex;justify-content:space-between;align-items:center">
    <strong>ğŸ“š Storybook</strong><button class="btn" id="Sx">âœ•</button></div>
    <div style="padding:8px"><input id="q" class="in" placeholder="ìŠ¤í† ë¦¬/íƒœê·¸ ê²€ìƒ‰"></div>
    <div id="L" class="list"></div>
    <div style="padding:8px;border-top:1px dashed var(--line)"><div class="meta" style="margin:6px 0 4px">ì±•í„°</div><div id="LC"></div></div>
  </aside>

  <header class="h">
    <button class="btn" id="So">â˜°</button><span class="badge" id="role">ì½ê¸° ì „ìš©</span>
    <div style="margin-left:auto"></div>
    <button class="btn" id="login">ê´€ë¦¬ì</button>
    <button class="btn only-admin" id="logout">ë¡œê·¸ì•„ì›ƒ</button>
    <button class="btn only-admin" id="edit">âœ í¸ì§‘</button>
    <select id="fs" class="in"><option>16</option><option selected>18</option><option>20</option><option>22</option></select>
    <select id="lh" class="in"><option>1.6</option><option selected>1.8</option><option>2</option></select>
    <input id="find" class="in" style="max-width:240px" placeholder="ì´ ìŠ¤í† ë¦¬ì—ì„œ ê²€ìƒ‰(Enter)">
  </header>

  <main class="m">
    <div class="title" id="t1">ì œëª©</div>
    <div class="meta" id="t2">â€”</div>
    <div style="display:flex;gap:10px;align-items:center;margin:12px 0">
      <div class="bar" style="width:220px"><div id="prog" class="p"></div></div>
      <div class="meta" id="pct">0%</div>
    </div>
    <article id="C" class="content"></article>
  </main>

  <footer class="f">
    <button class="btn" id="prev">â† ì´ì „</button>
    <button class="btn" id="next">ë‹¤ìŒ â†’</button>
    <div style="margin-left:auto" class="meta">ë‹¨ì¶•í‚¤: â†/â†’, / ë˜ëŠ” Ctrl+F</div>
  </footer>
</div>
<div id="BK" class="bk"></div>

<!-- ê´€ë¦¬ì ì„œë -->
<aside id="DR" class="dr only-admin" aria-label="ê´€ë¦¬ì">
  <div class="hd"><strong>ê´€ë¦¬ì í¸ì§‘</strong><div style="margin-left:auto"></div><button class="btn" id="drX">ë‹«ê¸°</button></div>
  <div class="bd">
    <label class="meta">ìŠ¤í† ë¦¬</label><select id="selS" class="in"></select>
    <label class="meta">ì±•í„°</label><div style="display:flex;gap:6px"><select id="selC" class="in" style="flex:1"></select><button class="btn" id="addC">+ì¶”ê°€</button><button class="btn" id="delC">-ì‚­ì œ</button></div>
    <input id="ct" class="in" placeholder="ì±•í„° ì œëª©">
    <div id="ed" class="ed" contenteditable="true"></div>
    <div style="display:flex;gap:6px;align-items:center">
      <input type="file" id="img" accept="image/*" class="hidden"><button class="btn" id="imgB">ì´ë¯¸ì§€</button>
      <button class="btn" id="saveC">ì €ì¥</button>
      <button class="btn" id="exp">ë‚´ë³´ë‚´ê¸°(JSON)</button>
      <label class="btn">ê°€ì ¸ì˜¤ê¸°<input id="imp" type="file" accept="application/json" class="hidden"></label>
    </div>
    <div class="meta">ì´ë¯¸ì§€: ë²„íŠ¼/ë¶™ì—¬ë„£ê¸°/ë“œë˜ê·¸ì•¤ë“œë¡­ ê°€ëŠ¥</div>
  </div>
</aside>

<script>
/* ===== ìµœì†Œ ì„¤ì • ===== */
const ADMIN_PASS="changeme"; /* â† ë°°í¬ ì „ì— ë°”ê¾¸ì„¸ìš” */

/* ===== ìƒ˜í”Œ ë°ì´í„°(ì§§ê²Œ) ===== */
const DFT=[{id:"fox",title:"ì‘ì€ ì—¬ìš°ì˜ ëª¨í—˜",tags:["ë™í™”","ëª¨í—˜"],chapters:[
 {title:"ìˆ²ì˜ ì•„ì¹¨",html:"<p>ì‘ì€ ì—¬ìš° ì—°í˜¸ëŠ” ì´ìŠ¬ ë§ºíŒ í’€ë°­ì„ ê°€ë¥´ë©° ë‹¬ë ¸ì–´ìš”.</p><p>ì˜¤ëŠ˜ì€ í° ê°•ì„ ê±´ë„ˆ ìƒˆë¡œìš´ ì¹œêµ¬ë¥¼ ë§Œë‚˜ëŸ¬ ê°€ìš”.</p>"},
 {title:"ê°•ì˜ ë…¸ë˜",html:"<p>ê°•ì€ ë°˜ì§ì´ë©° ë…¸ë˜í–ˆê³ , ì—¬ìš°ëŠ” ê·¸ ë…¸ë˜ì˜ ì˜ë¯¸ë¥¼ ì•Œì•„ì°¨ë¦¬ë ¤ í–ˆì£ .</p>"},
 {title:"ì €ë…ë†€",html:"<p>í•˜ëŠ˜ì´ ë¶‰ê²Œ ë¬¼ë“¤ì, ì—¬ìš°ëŠ” ì˜¤ëŠ˜ì˜ ìš©ê¸°ë¥¼ ë§ˆìŒì— ì €ì¥í–ˆì–´ìš”.</p>"}]},
{id:"notes",title:"ì½”ë”© ìˆ˜ì²©",tags:["ê°œë°œ","íŒ"],chapters:[
 {title:"ë¬¸ìì—´",html:"<p><strong>ë¬¸ìì—´ì€ ë¶ˆë³€</strong>ì…ë‹ˆë‹¤. ê²°í•©ë³´ë‹¤ <code>Array.join()</code>ì„ ê³ ë ¤í•˜ì„¸ìš”.</p>"},
 {title:"ë¹„ë™ê¸°",html:"<p><em>async/await</em>ì€ ê°€ë…ì„±â†‘, ë³‘ë ¬ì€ <code>Promise.all</code>.</p>"}]}];

/* ===== ìƒíƒœ ===== */
const LS={g:(k,d)=>{try{return JSON.parse(localStorage.getItem(k))??d}catch{return d}},s:(k,v)=>localStorage.setItem(k,JSON.stringify(v))};
let lib=LS.g("lib",DFT),cur=LS.g("cur",lib[0].id),idx=LS.g("idx",0),fs=LS.g("fs",18),lh=LS.g("lh",1.8),admin=sessionStorage.getItem("adm")==="1";

/* ===== ë„ìš°ë¯¸ ===== */
const $=id=>document.getElementById(id), by=id=>lib.find(s=>s.id===id), clamp=(n,a,b)=>Math.max(a,Math.min(b,n));
function save(){LS.s("lib",lib);LS.s("cur",cur);LS.s("idx",idx);LS.s("fs",fs);LS.s("lh",lh)}
function setAdmin(on){admin=on; if(on){document.body.classList.add("admin");$("role").textContent="ê´€ë¦¬ì";sessionStorage.setItem("adm","1")}else{document.body.classList.remove("admin");$("role").textContent="ì½ê¸° ì „ìš©";sessionStorage.removeItem("adm")}}
function hi(html,term){if(!term)return html;const s=term.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return html.replace(new RegExp("("+s+")","gi"),"<mark>$1</mark>")}
function renderList(filter=""){const q=filter.trim().toLowerCase();$("L").innerHTML="";lib.filter(s=>!q||s.title.toLowerCase().includes(q)||(s.tags||[]).some(t=>t.toLowerCase().includes(q))).forEach(s=>{const d=document.createElement("div");d.className="item"+(s.id===cur?" a":"");d.innerHTML=`<div>${s.title}</div><div class="meta">${(s.tags||[]).join(", ")}</div>`;d.onclick=()=>{cur=s.id;idx=0;save();renderAll();closeSide()};$("L").appendChild(d)});const st=by(cur);$("LC").innerHTML="";st.chapters.forEach((c,i)=>{const x=document.createElement("div");x.className="ch"+(i===idx?" a":"");x.textContent=(i+1)+". "+c.title;x.onclick=()=>{idx=i;save();renderMain($("find").dataset.t||"")};$("LC").appendChild(x)})}
function renderMain(term=""){const s=by(cur),c=s.chapters[clamp(idx,0,s.chapters.length-1)];idx=s.chapters.indexOf(c);$("t1").textContent=s.title;$("t2").textContent=`${idx+1}/${s.chapters.length}ì¥`;$("C").innerHTML=hi(c.html||"",term);const p=Math.round(((idx+1)/s.chapters.length)*100);$("prog").style.width=p+"%";$("pct").textContent=p+"%";[...$("LC").children].forEach((n,i)=>n.classList.toggle("a",i===idx));save()}
function renderAll(term=""){renderList($("q").value);renderMain(term);document.documentElement.style.setProperty("--fs",fs+"px");document.documentElement.style.setProperty("--lh",lh);$("fs").value=String(fs);$("lh").value=String(lh)}

/* ===== ì´ë²¤íŠ¸ ===== */
$("next").onclick=()=>{const s=by(cur);idx=clamp(idx+1,0,s.chapters.length-1);save();renderMain($("find").dataset.t||"")};
$("prev").onclick=()=>{const s=by(cur);idx=clamp(idx-1,0,s.chapters.length-1);save();renderMain($("find").dataset.t||"")};
$("find").onkeydown=e=>{if(e.key==="Enter"){const t=e.target.value.trim();e.target.dataset.t=t;renderMain(t)}};
$("q").oninput=e=>renderList(e.target.value);
$("fs").onchange=e=>{fs=+e.target.value;save();renderAll()};
$("lh").onchange=e=>{lh=+e.target.value;save();renderAll()};
document.addEventListener("keydown",e=>{if(e.target.closest("input,[contenteditable]"))return;if(e.key==="ArrowRight")$("next").click();if(e.key==="ArrowLeft")$("prev").click();if(e.key==="/"||(e.ctrlKey&&e.key.toLowerCase()==="f")){e.preventDefault();$("find").focus();}});

/* ì‚¬ì´ë“œë°” (ëª¨ë°”ì¼) */
const S=$("S"),BK=$("BK");function openSide(){S.classList.add("on");BK.classList.add("on")}function closeSide(){S.classList.remove("on");BK.classList.remove("on")}
$("So").onclick=openSide;$("Sx").onclick=closeSide;BK.onclick=closeSide;

/* ê´€ë¦¬ì */
$("login").onclick=()=>{const v=prompt("ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸"); if(v===ADMIN_PASS){setAdmin(true); alert("ê´€ë¦¬ì ëª¨ë“œ");} else alert("í‹€ë ¸ìŠµë‹ˆë‹¤")};
$("logout").onclick=()=>setAdmin(false);

/* ê´€ë¦¬ì ì„œë */
const DR=$("DR");$("edit").onclick=()=>DR.classList.add("on");$("drX").onclick=()=>DR.classList.remove("on");
const selS=$("selS"),selC=$("selC"),ct=$("ct"),ed=$("ed"),img=$("img");
function refreshSel(){selS.innerHTML=lib.map(s=>`<option value="${s.id}">${s.title}</option>`).join("");selS.value=cur;refreshChap()}
function refreshChap(){const s=by(selS.value);selC.innerHTML=s.chapters.map((c,i)=>`<option value="${i}">${i+1}. ${c.title}</option>`).join("");selC.value=String(idx);loadChap()}
function loadChap(){const s=by(selS.value),i=+selC.value,c=s.chapters[i];ct.value=c.title||"";ed.innerHTML=c.html||""}
selS.onchange=refreshChap;selC.onchange=loadChap;
$("addC").onclick=()=>{const s=by(selS.value);s.chapters.push({title:"ìƒˆ ì±•í„°",html:"<p>ë‚´ìš©</p>"});idx=s.chapters.length-1;save();refreshChap();renderAll()}
$("delC").onclick=()=>{const s=by(selS.value),i=+selC.value;if(!confirm("ì‚­ì œí• ê¹Œìš”?"))return;s.chapters.splice(i,1);idx=Math.max(0,Math.min(idx,s.chapters.length-1));save();refreshChap();renderAll()}
$("saveC").onclick=()=>{const s=by(selS.value),i=+selC.value,c=s.chapters[i];c.title=ct.value.trim()||c.title;c.html=ed.innerHTML;save();renderAll();alert("ì €ì¥ë¨")}
$("imgB").onclick=()=>img.click();img.onchange=e=>{const f=e.target.files?.[0];if(!f)return;const r=new FileReader();r.onload=()=>insImg(r.result);r.readAsDataURL(f);e.target.value=""}
ed.addEventListener("paste",e=>{const it=e.clipboardData?.items||[];for(const x of it){if(x.type?.startsWith("image/")){e.preventDefault();const f=x.getAsFile(),r=new FileReader();r.onload=()=>insImg(r.result);f&&r.readAsDataURL(f);return}}});
ed.addEventListener("dragover",e=>e.preventDefault());ed.addEventListener("drop",e=>{e.preventDefault();const F=e.dataTransfer?.files||[];for(const f of F){if(f.type.startsWith("image/")){const r=new FileReader();r.onload=()=>insImg(r.result);r.readAsDataURL(f)}}});
function insImg(src){const i=new Image();i.src=src;i.style.maxWidth="100%";i.style.borderRadius="14px";i.style.display="block";i.style.margin="10px auto";const s=window.getSelection(),r=s&&s.rangeCount?s.getRangeAt(0):null;if(!r){const rr=document.createRange();rr.selectNodeContents(ed);rr.collapse(false);s.removeAllRanges();s.addRange(rr)}window.getSelection().getRangeAt(0).insertNode(i);ed.focus()}
$("exp").onclick=()=>{const s=by(selS.value);const b=new Blob([JSON.stringify(s,null,2)],{type:"application/json"});const u=URL.createObjectURL(b);const a=document.createElement("a");a.href=u;a.download=s.id+".json";a.click();setTimeout(()=>URL.revokeObjectURL(u),300)}
$("imp").onchange=e=>{const f=e.target.files?.[0];if(!f)return;const r=new FileReader();r.onload=()=>{try{const o=JSON.parse(r.result);if(!o.id||!o.title||!Array.isArray(o.chapters))throw new Error("í˜•ì‹ì˜¤ë¥˜");lib=lib.filter(x=>x.id!==o.id);lib.unshift(o);cur=o.id;idx=0;save();refreshSel();renderAll();alert("ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ")}catch(err){alert("ì‹¤íŒ¨: "+err.message)}};r.readAsText(f,"utf-8");e.target.value=""}

/* ì´ˆê¸°í™” */
function init(){if(!by(cur))cur=lib[0].id;document.documentElement.style.setProperty("--fs",fs+"px");document.documentElement.style.setProperty("--lh",lh);renderAll();setAdmin(admin);refreshSel()}
init();
</script>
</body></html>
