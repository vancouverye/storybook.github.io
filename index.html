<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>ì—°í˜¸ì˜ ìŠ¤í† ë¦¬ë¶</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0a0f18;--bg2:#0d1424;--glass:#0f1726cc;--solid:#0f1726;
  --line:#1c2a40;--ink:#eaf1fb;--mut:#9fb0c3;--mute:#7d91a7;
  --pri:#6ea3ff;--pri2:#4f7ef3;--r:16px;--sh:0 22px 55px rgba(0,0,0,.45);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;font-family:Inter,-apple-system,Segoe UI,Roboto,"Noto Sans KR",sans-serif;color:var(--ink);
  background:radial-gradient(70% 90% at 10% 0,#14213d 0,transparent 55%),radial-gradient(70% 80% at 100% 0,#12203a 0,transparent 50%),linear-gradient(180deg,#0a0f18 0,#0c1424 45%,#0a0f18 100%);
}
.app{display:grid;grid-template-rows:68px 1fr;min-height:100vh}
.header{position:sticky;top:0;z-index:50;display:flex;align-items:center;gap:12px;padding:10px 16px;
  background:#0b1322cc;border-bottom:1px solid var(--line);backdrop-filter:blur(12px)}
.brand{font-weight:800}
.header-nav{margin-left:auto;display:flex;gap:8px;flex-wrap:wrap}
.btn{
  background:linear-gradient(180deg,#111b33,#0d1629);border:1px solid var(--line);color:var(--ink);
  padding:10px 14px;border-radius:12px;cursor:pointer;transition:.15s;box-shadow:inset 0 -1px 0 rgba(255,255,255,.04)
}
.btn:hover{border-color:#2a3b5e;transform:translateY(-1px)}
.btn.pri{background:linear-gradient(180deg,var(--pri),var(--pri2));border-color:transparent;color:#fff}
.main{padding:22px}.container{max-width:1200px;margin:0 auto;display:grid;gap:18px}
.section{display:none}.section.show{display:block}
.card{background:var(--glass);border:1px solid var(--line);border-radius:var(--r);box-shadow:var(--sh);padding:16px}
.grid{display:grid;gap:16px}
.cols-2{grid-template-columns:repeat(2,1fr)}@media(max-width:940px){.cols-2{grid-template-columns:1fr}}
.tabs{display:flex;gap:10px;overflow:auto;padding:8px 2px}
.tab{border:1px solid var(--line);background:#0e1627;color:var(--ink);padding:8px 14px;border-radius:999px;white-space:nowrap;cursor:pointer}
.tab.active{border-color:transparent;background:linear-gradient(90deg,var(--pri),var(--pri2));color:#fff}
.story{background:linear-gradient(180deg,#0f1a2e,#0f1729);border:1px solid var(--line);
  border-radius:18px;padding:16px}
.story h4{margin:0}.story p{margin:6px 0;color:var(--mute)}
.actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
input,textarea,select{width:100%;background:#0b1422;border:1px solid var(--line);color:var(--ink);padding:11px;border-radius:12px}
textarea{resize:vertical}
.spinner{width:44px;height:44px;border:3px solid #1a2840;border-top-color:var(--pri);border-radius:50%;animation:spin 1s linear infinite;margin:20px auto}
@keyframes spin{to{transform:rotate(360deg)}}
.toast{position:fixed;right:16px;bottom:16px;background:#0b1322e6;border:1px solid var(--line);padding:10px 14px;border-radius:12px;display:none;z-index:400}
.modal{position:fixed;inset:0;background:#0008;display:none;align-items:center;justify-content:center;z-index:350}
.modal.on{display:flex}
.modal .box{width:min(780px,92vw);background:var(--solid);border:1px solid var(--line);border-radius:18px;box-shadow:var(--sh);padding:16px}
.mut{color:var(--mut)}.badge{display:inline-block;padding:2px 8px;border:1px solid var(--line);border-radius:999px;font-size:12px;color:#b9c8dc}
</style>
</head>
<body>
<div class="app">
  <div class="header">
    <div class="brand">ğŸ“š ì—°í˜¸ì˜ ìŠ¤í† ë¦¬ë¶</div>
    <div class="header-nav">
      <button class="btn" data-page="home">í™ˆ</button>
      <button class="btn" data-page="stories">ìŠ¤í† ë¦¬ë¶</button>
      <button class="btn" data-page="next">ë‹¤ìŒ ì´ì•¼ê¸°</button>
      <button class="btn" data-page="groups">ê·¸ë£¹</button>
      <button class="btn pri" data-page="admin">ê´€ë¦¬ì</button>
    </div>
  </div>
  <div class="main">
    <div class="container">
      <section id="home" class="section show"><div class="card"><h2>í™˜ì˜í•©ë‹ˆë‹¤ ğŸ‘‹</h2><p>ì‹œë¦¬ì¦ˆë³„ë¡œ ì±…ì„ ì½ê³ , ë‹¤ìŒ ì´ì•¼ê¸°ë¥¼ ì œì•ˆí•´ë³´ì„¸ìš”.</p></div><div class="card"><h3>ìµœê·¼ ì±…</h3><div id="home-stories" class="grid cols-2"></div></div></section>
      <section id="stories" class="section"><div class="card"><h2>ìŠ¤í† ë¦¬ë¶</h2><div id="series-tabs" class="tabs"></div><div id="series-desc" class="mut"></div><div id="story-list" class="grid cols-2"></div><div id="story-loading" class="spinner" style="display:none"></div></div></section>
      <section id="next" class="section"><div class="card"><h2>ë‹¤ìŒ ì´ì•¼ê¸°ëŠ” ë¬´ì—‡ì¼ê¹Œ</h2><form id="next-form" class="grid"><input id="nx-author" placeholder="ì‘ì„±ì (ë‹‰ë„¤ì„)" required><input id="nx-title" placeholder="ì œëª©" required><textarea id="nx-text" rows="4" placeholder="ë‚´ìš©" required></textarea><button class="btn pri" type="submit">ì œì•ˆ ë“±ë¡</button></form></div><div class="card"><h3>ì œì•ˆ ëª©ë¡</h3><div id="next-list" class="grid"></div></div></section>
      <section id="groups" class="section"><div class="card"><h2>ê·¸ë£¹</h2><div id="group-list" class="grid cols-2"></div></div></section>
      <section id="admin" class="section"><div id="admin-login" class="card"><h2>ê´€ë¦¬ì ë¡œê·¸ì¸</h2><input id="admin-pass" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥"><button class="btn pri" id="btnAdminLogin">ë¡œê·¸ì¸</button></div><div id="admin-panel" class="card" style="display:none"><h3>ê´€ë¦¬ ì½˜ì†”</h3><button class="btn pri" id="openSeries">+ ì‹œë¦¬ì¦ˆ</button><button class="btn pri" id="openStory">+ ì±…</button><button class="btn pri" id="openGroup">+ ê·¸ë£¹</button><h4>â€˜ë‹¤ìŒ ì´ì•¼ê¸°â€™ ì œì•ˆ ê´€ë¦¬</h4><div id="admin-next"></div></div></section>
    </div>
  </div>
</div>
<div id="toast" class="toast"></div>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
<script>
const firebaseConfig={
  apiKey: "AIzaSyBEBA0ZUVcMBG_G9CtauP02kh4Wneg-5gA",
  authDomain: "storybook-4a13b.firebaseapp.com",
  projectId: "storybook-4a13b",
  storageBucket: "storybook-4a13b.firebasestorage.app",
  messagingSenderId: "756981563455",
  appId: "1:756981563455:web:b0bef64ba3ca2fb39a788a",
  measurementId: "G-CPXLQYTYJY"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();
const ADMIN_PASSWORD="admin1234";let isAdmin=false;
const $=id=>document.getElementById(id);const $$=(s,r=document)=>Array.from(r.querySelectorAll(s));
function toast(m){const t=$("toast");t.textContent=m;t.style.display="block";setTimeout(()=>t.style.display="none",1500);}
function show(id){$$(".section").forEach(s=>s.classList.remove("show"));$(id).classList.add("show");}
$$("[data-page]").forEach(b=>b.onclick=()=>show(b.dataset.page));

$("btnAdminLogin").onclick=()=>{if($("admin-pass").value===ADMIN_PASSWORD){isAdmin=true;$("admin-login").style.display="none";$("admin-panel").style.display="block";toast("ê´€ë¦¬ì ë¡œê·¸ì¸ ì™„ë£Œ");renderAdminNext();}else alert("ë¹„ë°€ë²ˆí˜¸ í‹€ë¦¼");};

$("next-form").onsubmit=async e=>{e.preventDefault();const a=$("nx-author").value.trim(),t=$("nx-title").value.trim(),x=$("nx-text").value.trim();if(!a||!t||!x)return;await db.collection("nextProposals").add({author:a,title:t,text:x,status:"pending",created:new Date()});toast("ì œì•ˆ ë“±ë¡ ì™„ë£Œ!");renderNextList();};

async function renderNextList(){const box=$("next-list");box.innerHTML="";const snap=await db.collection("nextProposals").orderBy("created","desc").get();if(snap.empty){box.innerHTML='<div class="mut">ì•„ì§ ì œì•ˆì´ ì—†ìŠµë‹ˆë‹¤.</div>';return;}snap.forEach(doc=>{const p=doc.data();const el=document.createElement("div");el.className="story";el.innerHTML=`<div class="badge">${p.status}</div><h4>${p.title}</h4><p>${p.text}</p><div class="mut">${p.author||"ìµëª…"}</div>${isAdmin?'<button class="btn" data-approve>ìŠ¹ì¸</button><button class="btn" data-reject>ê±°ì ˆ</button>':""}`;if(isAdmin){el.querySelector("[data-approve]").onclick=async()=>{await db.collection("nextProposals").doc(doc.id).update({status:"approved"});toast("ìŠ¹ì¸ë¨");renderNextList();};el.querySelector("[data-reject]").onclick=async()=>{await db.collection("nextProposals").doc(doc.id).update({status:"rejected"});toast("ê±°ì ˆë¨");renderNextList();}};box.appendChild(el);});}
async function renderAdminNext(){const box=$("admin-next");box.innerHTML="";const snap=await db.collection("nextProposals").orderBy("created","desc").get();snap.forEach(d=>{const p=d.data();const e=document.createElement("div");e.className="story";e.innerHTML=`<h4>${p.title}</h4><div>${p.status}</div>`;box.appendChild(e);});}
window.onload=()=>{show("home");renderNextList();}
</script>
</body>
</html>
